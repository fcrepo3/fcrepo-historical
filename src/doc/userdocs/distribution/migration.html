<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
                      
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
    <title>Fedora Upgrade and Migration Guide</title>
    <link rel="stylesheet" type="text/css" href="../docstyle.css" />
</head>

<body>
<div id="header">
    <a href="../index.html" id="logo"></a>
    <div id="title">
        <h1>Fedora Upgrade and Migration Guide</h1>
        <h2>Fedora Release 2.1.1</h2>
    </div>
</div>

<div class="toc">
    <h2>Table of Contents</h2>
    <div class="tocbox">
        
    <ol>
		<li><a href="#migrate21-211">Upgrading from Fedora 2.1 to Fedora 2.1.1</a></li>
		<li><a href="#migrate20-211">Upgrading from Fedora 2.0 to Fedora 2.1.1</a></li>
		<li><a href="#migratepre20">Upgrading from versions prior to 2.0</a></li>
    </ol>
    </div>
</div>

<div class="sec2">
  <h2><a name="migrate21-211" id="migrate0">1. Upgrading From Fedora 2.1 to Fedora 
    2.1.1</a></h2>

	<p>The move from Fedora 2.1 to Fedora 2.1.1 is quite simple and does not 
	require migration of objects or rebuilding of the resource index. There are, 
	however, important configuration and script changes between 2.1 and 2.1.1.
    These changes include the following:</p>
    <ul>
      <li> <b>fedora.fcfg</b> - Fedora's Lowlevel storage was refactored
          into a module and the following configuration values were moved into
          a that new module's configuration section:
          <tt>object_store_base</tt>, 
          <tt>datastream_store_base</tt>, 
          <tt>path_registry</tt>, 
          <tt>path_algorithm</tt>, 
          <tt>file_system</tt>, and 
          <tt>backslash_is_escape</tt>
      </li>
      <li> <b>web.xml</b> - This file was modified so that the Fedora 
           webapp starts as part of the tomcat startup process,
           rather than being triggered by a special HTTP request
           to the ServerController servlet.
      </li>
      <li> <b>fedora-start and fedora-stop scripts</b> - These were
           modified to print the server's status at startup and
           shutdown time, and to return appropriate error codes.
           The fedora-start script also now includes logic to stop
           Tomcat automatically if Fedora webapp initialization fails.
      </li>
    </ul>
    
    <p>Follow these steps to upgrade your Fedora server from 2.1 to
       2.1.1.</p>
		
  <ol>
  	<li><b>Backup:</b> it is highly recommended that you create a backup 
      of your existing Fedora 2.1 repository </li>
    <li><b>Download: </b>download the Fedora 2.1.1 software from <a href=
        "http://www.fedora.info/download">http://www.fedora.info/download</a></li>
    <li><b>Install</b>: install the Fedora 2.1.1 software</li>

    <li><b>Run the Fedora Setup Utility.</b>&nbsp; In Fedora 2.1.1, you can choose 
      among four different security configurations. <b>&nbsp;</b>Consult the <a href="../server/security/securingrepo.html">Securing 
      Your Repository Guide</a> for a description of security configuration options.&nbsp; 
      To have an equivalent configuration to what was in Fedora 2.0 (no SSL, API-M 
      authentication, open API-A) select the &quot;no-ssl-authenticate-apim&quot; 
      option as demonstrated below.&nbsp; You can easily change to more secure 
      configurations at any time by rerunning the Fedora Setup Utility.&nbsp; 
      <br>
      &nbsp; 
      <div class="code"><pre>C:\fedora-2.1.1&gt;<b> fedora-setup no-ssl-authenticate-apim</b></pre></div>
      <p>&nbsp;</p>
    </li>
    <li><b>Configure Object Storage Location: </b>&nbsp;in the Fedora 2.1.1 server 
      configuration file (fedora.fcfg) set the object storage location to point 
      to that of of the Fedora 2.1.1 repository, for example:<br>
      &nbsp; 
      <div class="code"><pre>&lt;param name=&quot;object_store_base&quot; value=&quot;<b>C:\fedora2_1_objects</b>&quot; isFilePath=&quot;true&quot;/&gt;</pre></div>
      <p>&nbsp; 
    </li>
    <li><b>Configure Datastream Storage Location:</b> in the Fedora 2.1.1 server 
      configuration file (fedora.fcfg) set the datastream storage location to 
      point to that of of the Fedora 2.1 repository, for example:<br>
      &nbsp; 
      <div class="code"><pre>&lt;param name=&quot;datastream_store_base&quot; value=&quot;<b>C:\fedora2_1_datastreams</b>&quot; isFilePath=&quot;true&quot;/&gt;</pre></div>
      <p>&nbsp; 
    </li>
    <li><b>Configure the Resource Index Storage Location:</b> in the Fedora 2.1.1 
      server configuration file (fedora.fcfg) set the resource index storage location 
      to point to that of of the Fedora 2.1 repository, for example:<br>
      &nbsp; 
      <div class="code"><pre>&lt;datastore id=&quot;localKowariTriplestore&quot;&gt;<br>  &lt;comment&gt;local Kowari Triplestore used by the Resource Index&lt;/comment&gt;<br>  &lt;param name=&quot;connectorClassName&quot; value=&quot;org.trippi.impl.kowari.KowariConnector&quot;/&gt;<br>  &lt;param name=&quot;remote&quot; value=&quot;false&quot;/&gt;<br>  &lt;param name=&quot;path&quot; value=&quot;C:\fedora2_1_resourceIndex&quot;/&gt;<br>  &lt;param name=&quot;serverName&quot; value=&quot;fedora&quot;/&gt;<br>  &lt;param name=&quot;modelName&quot; value=&quot;ri&quot;/&gt;<br>  &lt;param name=&quot;poolInitialSize&quot; value=&quot;3&quot;/&gt;<br>  &lt;param name=&quot;poolMaxGrowth&quot; value=&quot;-1&quot;/&gt;<br>  &lt;param name=&quot;readOnly&quot; value=&quot;false&quot;/&gt;<br>  &lt;param name=&quot;autoCreate&quot; value=&quot;true&quot;/&gt;<br>  &lt;param name=&quot;autoTextIndex&quot; value=&quot;false&quot;/&gt;<br>  &lt;param name=&quot;memoryBuffer&quot; value=&quot;true&quot;/&gt;<br>  &lt;param name=&quot;autoFlushDormantSeconds&quot; value=&quot;5&quot;/&gt;<br>  &lt;param name=&quot;autoFlushBufferSize&quot; value=&quot;20000&quot;/&gt;<br>  &lt;param name=&quot;bufferFlushBatchSize&quot; value=&quot;20000&quot;/&gt;<br>  &lt;param name=&quot;bufferSafeCapacity&quot; value=&quot;40000&quot;/&gt;<br>&lt;/datastore&gt;</pre></div>
      <p>&nbsp; 
    </li>	
    <li><b>Configure the SQL Database Location:</b>&nbsp; in the Fedora 2.1.1 server 
      configuration file (fedora.fcfg) set the relational database location topoint 
      to the pre-existing database (used by the Fedora 2.1 repository), for example 
      (if using MySQL):<br>
      &nbsp; 
      <div class="code"><pre>&lt;datastore id=&quot;localMySQLPool&quot;&gt;
  &lt;param name=&quot;dbUsername&quot; value=&quot;fedoraAdmin&quot;/&gt;
  &lt;param name=&quot;dbPassword&quot; value=&quot;fedoraAdmin&quot;/&gt;
  <b>&lt;param name=&quot;jdbcURL&quot; value=&quot;jdbc:mysql://localhost/fedora21?useUnicode=true&amp;amp;characterEncoding=UTF-8&amp;amp;autoReconnect=true&quot;/&gt;</b>
  &lt;param name=&quot;jdbcDriverClass&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;
  &lt;param name=&quot;ddlConverter&quot; value=&quot;fedora.server.utilities.MySQLDDLConverter&quot;/&gt;
  &lt;param name=&quot;maxActive&quot; value=&quot;100&quot;/&gt;
  &lt;param name=&quot;maxIdle&quot; value=&quot;10&quot;/&gt;
  &lt;param name=&quot;maxWait&quot; value=&quot;-1&quot;/&gt;
  &lt;param name=&quot;minIdle&quot; value=&quot;0&quot;/&gt;
  &lt;param name=&quot;minEvictableIdleTimeMillis&quot; value=&quot;1800000&quot;/&gt;
  &lt;param name=&quot;numTestsPerEvictionRun&quot; value=&quot;3&quot;/&gt;
  &lt;param name=&quot;timeBetweenEvictionRunsMillis&quot; value=&quot;-1&quot;/&gt;
  &lt;param name=&quot;testOnBorrow&quot; value=&quot;true&quot;/&gt;
  &lt;param name=&quot;testOnReturn&quot; value=&quot;true&quot;/&gt;
  &lt;param name=&quot;testWhileIdle&quot; value=&quot;true&quot;/&gt;
  &lt;param name=&quot;whenExhaustedAction&quot; value=&quot;1&quot;/&gt;
&lt;/datastore&gt;</pre></div>
      <p>&nbsp;If you are using Oracle or mckoi as your database, update the appropriate 
        datastore configuration.<br>
        &nbsp;
    </li>
    <li><b>Configure the fedoraServerHost and fedoraServerPort:</b> in the Fedora 
      2.1.1 server configuration file (fedora.fcfg) set the values for fedoraServerHost 
      and fedoraServerPort to match those of your Fedora 2.1 server configuration, 
      for example:<br>
      &nbsp; 
      <div class="code"><pre>&lt;param name=&quot;fedoraServerPort&quot; value=&quot;8080&quot;&gt;<br>  &lt;comment&gt;Defines the port number on which the Fedora server runs;<br>           default is 8080.&lt;/comment&gt;<br>&lt;/param&gt;<br>&lt;param name=&quot;fedoraShutdownPort&quot; value=&quot;8005&quot;&gt;<br>  &lt;comment&gt;Defines the port number used to shutdown the Fedora sever;<br>           default is 8005.&lt;/comment&gt;<br>&lt;/param&gt;<br>&lt;param name=&quot;fedoraRedirectPort&quot; value=&quot;8443&quot;&gt;<br>  &lt;comment&gt;Defines the redirect port of the Fedora sever; default is<br>           8443.&lt;/comment&gt;<br>&lt;/param&gt;<br>&lt;param name=&quot;fedoraServerHost&quot; value=&quot;localhost&quot;&gt;<br>  &lt;comment&gt;Defines the host name for the Fedora server, as seen from the<br>           outside world.&lt;/comment&gt;<br>&lt;/param&gt;</pre></div>
      <p>&nbsp; 
    </li>
    <li>Start the Fedora 2.1.1 server <br>
      &nbsp; 
      <div class="code"><pre>C:\fedora-2.1.1&gt;<b> fedora-start</b>
Starting the Fedora server...
2006-04-04 12:37:57PM EDT - Waiting for startup to begin
2006-04-04 12:38:12PM EDT - Starting Fedora Server instance
2006-04-04 12:38:12PM EDT - Initializing Server
2006-04-04 12:38:13PM EDT - Fedora Version: 2.1.1
2006-04-04 12:38:13PM EDT - Fedora Build: 1
2006-04-04 12:38:13PM EDT - Server Host Name: localhost
2006-04-04 12:38:13PM EDT - Server Port: 8080
2006-04-04 12:38:13PM EDT - Debugging: OFF
2006-04-04 12:38:13PM EDT - Initializing Modules
2006-04-04 12:38:16PM EDT - Post-Initializing Modules
2006-04-04 12:38:17PM EDT - Initializing XACML Authorization Module
2006-04-04 12:38:24PM EDT - Started
<b>Finished. To stop server, use fedora-stop.
C:\fedora-2.1.1&gt;</b></pre></div>
      <p>&nbsp;</p>
    </li>
    <li><i><b>You are done! </b></i></li>
  </ol>
</div>

<div class="sec2">
	<h2><a name="migrate20-211" id="migrate0">2. Upgrading From Fedora 2.0 to 
	Fedora 2.1.1</a></h2>
    <p>When moving from Fedora 2.0 to Fedora 2.1.1 you will be able to do a simple 
    software <i><b>upgrade</b></i> without having to migrate digital objects via 
    a mass export and ingest. After you install Fedora 2.1.1, you can 
    configure it to point to your existing repository datastores (both the existing 
    repository directory storage locations and the existing relational database).&nbsp; 
    This involves changing parameters in the Fedora 2.1.1 server configuration file 
    (fedora.fcfg) that define the storage directory paths and database location.&nbsp; 
    See the instructions in section 1 above for details.</p>
    
    <p>Note that the Resource Index model changed between 2.0 and 2.1, hence a 
    rebuild of the Resource Index is necessary if upgrading from 2.0 to 2.1.1. 
    See the intructions for 
    <a href="../server/cmd-line/index.html#rebuild">rebuilding the Resource Index</a>.</p>
</div>

<div class="sec2">
	<h2><a name="migratepre20" id="migrate0">3. Upgrading from versions prior to 2.0</a></h2>
    <p>To upgrade from a Fedora version prior to 2.0, you must first
       <a href="http://fedora.info/download/2.0/userdocs/distribution/migration.html">migrate to version 2.0</a>, then follow the appropriate upgrade steps above.</p>
    </p> 
</div>

<div id="footer">
    <div id="copyright">
      Copyright &#xA9; 2006 Fedora Project
    </div>

    <div id="lastModified">
      Last Modified <script type="text/javascript">
      //<![CDATA[
            var cvsDate = "$Date$";
            var parts = cvsDate.split(" ");
            var modifiedDate = parts[1];
            document.write(modifiedDate);
      //]]>
      </script>
    </div>
</div>
</body>
</html>
