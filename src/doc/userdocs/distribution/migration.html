<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
	<title>Fedora Upgrade and Migration Guide</title>
	<link rel="stylesheet" type="text/css" href="../docstyle.css" />
</head>

<body>
<div id="header">
	<a href="../index.html" id="logo"></a>

    <div id="title">
		<h1>Fedora Upgrade and Migration Guide</h1>
		<h2>Fedora Release 2.2.1</h2>
	</div>
</div>

<div id="toc">
    <h2>Table of Contents</h2>
    <div id="tocbox">
        <ol>
      		<li><a href="#migrate22">Upgrading from Fedora 2.2 to Fedora 2.2.1</a></li>
      		<li><a href="#migrate211">Upgrading from Fedora 2.1.1 to Fedora 2.2.1</a></li>
      		<li><a href="#migrate21">Upgrading from Fedora 2.1 to Fedora 2.2.1</a></li>
      		<li><a href="#migrate20">Upgrading from Fedora 2.0 to Fedora 2.2.1</a></li>
      		<li><a href="#migratepre20">Upgrading from versions prior to 2.0</a></li>
        </ol>
    </div>
</div>

<div class="sect">
    <a name="migrate22"> </a>
	<h2><a name="intro">1. Upgrading from Fedora 2.2 to Fedora 2.2.1</a></h2>
	<p>This is a minor upgrade that fixes the <a href="release-notes.html">bugs
    addressed by the Fedora 2.2.1 release</a>.  We have developed a
    utility to make this process as quick as possible.  
    <ol>
      <li> <a href="http://sourceforge.net/project/showfiles.php?group_id=177054&package_id=219723">Download fedora-2.2.1-upgrade.jar</a> from Sourceforge.</li>
      <li> Stop the webapp container in which Fedora is running.</li>
      <li> Run the upgrade utility: <code>java -jar fedora-2.2.1-upgrade.jar</code> and
           follow the prompts.</li>
      <li> Restart the webapp container.</li>
    </ol>
	<p>
    NOTE: Although the <i>Fedora Administrator</i> Java application will be upgraded as part
    of this process, existing tools and services that use <code>fedora-client.jar</code>
    version 2.2 <i>do not need the updated version of this library</i>
    in order to continue working properly with your upgraded server.
    <p>
</div>

<div class="sect">
	<h2><a name="intro">2. Upgrading from Fedora 2.1.1 to Fedora 2.2.1</a></h2>
	<p>Upgrading from Fedora 2.1.1 to Fedora 2.2.1 does not require 
	migration of objects or rebuilding of the Resource Index.
	However, there are important changes to the packaging and configuration 
	between 2.1.1 and 2.2.1. Notably, neither the Fedora Configuration File 
	(fedora.fcfg) nor Fedora Web Deployment Descriptor (web.xml) of previous 
	versions is compatible with Fedora 2.2.1.</p>
	
	<ol type="A">
		<li>Backup
			<p>It is highly recommended you backup your existing Fedora 
			repository.</p>
		</li>
        <li>
          Use your database's administrative tool or SQL command line
          utility to rename the "do" table to "dobj".  This is normally
          done via the SQL command:
          <code>
            ALTER TABLE do RENAME TO dobj
          </code>
        </li>
		<li>Install Fedora 2.2.1
			<p>Review the <a href="installation.html">Installation and 
			Configuration Guide</a>. Note the following critical steps of the 
			installation process:</p>
			<ol>
				<li><p>When prompted for the installation type, select 
				"custom".</p></li>
				<li><p>When prompted for the Fedora home directory, 
				<strong>DO NOT</strong> select the Fedora home directory of your 
				previous installation: select a new directory.</p></li>
				<li><p>When prompted for the Servlet engine, if you select an 
				existing Tomcat installation, <strong>DO NOT</strong> select the 
				servlet container of your previous Fedora installation.</p>
				<p>If you select an existing servlet container, please make 
				sure it is not running (or, ensure that it is not configured to 
				automatically deploy web applications).</p></li>
				<li><p>When prompted for the Database, select the database 
				(i.e., mysql, oracle, etc.) you used with your previous 
				installation of Fedora.</p>
				<p>Use the same database username, password, JDBC url, and 
				Driver Class used in the previous Fedora installation (refer to
				your old fedora.fcfg if needed).</p></li>
			</ol>
			
		</li>
		<li>Post install, edit your new Fedora Configuration File 
		($FEDORA_HOME/server/config/fedora.fcfg).
		
		<p>Copy the following parameter values from your old fedora.fcfg to your
		new fedora.fcfg:</p>
			<ol>
				<li>module.fedora.server.storage.lowlevel.ILowlevelStorage.object_store_base</li>
				<li>module.fedora.server.storage.lowlevel.ILowlevelStorage.datastream_store_base</li>
				<li>module.fedora.server.resourceIndex.ResourceIndex.level</li>
				<li>datastore.localKowariTriplestore.path</li>
			</ol>
		</li>
		<p>If you made any customizations to your previous fedora.fcfg, you may
		apply them now.</p>
	</ol>

</div>


<div class="sect">
	<h2><a name="migrate21">3. Upgrading From Fedora 2.1 to Fedora 2.2.1</a></h2>
	<p>Follow the steps in section 1 for upgrading from 2.1.1.</p>
</div>

<div class="sect">
	<h2><a name="migrate20">4. Upgrading From Fedora 2.0 to Fedora 2.2.1</a></h2>
	<p>When moving from Fedora 2.0 to Fedora 2.2.1, you will be able to do a simple 
    software <i><b>upgrade</b></i> without having to migrate digital objects via 
    a mass export and ingest. After installing Fedora 2.2.1, you can 
    configure it to point to your existing repository datastores (both the existing 
    repository directory storage locations and the existing relational database).
    This involves changing parameters in the Fedora 2.2.1 server configuration file 
    (fedora.fcfg) that define the storage directory paths and database location.
    See the instructions in section 1 above for details.</p>
    
    <p>Note that the Resource Index model changed between 2.0 and 2.1, hence a 
    rebuild of the Resource Index is necessary if upgrading from 2.0 to 2.2.1. 
    See the instructions for 
    <a href="../server/cmd-line/index.html#rebuild">rebuilding the Resource Index</a>.</p>
</div>

<div class="sect">
	<h2><a name="migratepre20">5. Upgrading from versions prior to 2.0</a></h2>
	<p>To upgrade from a Fedora version prior to 2.0, you must first
	<a href="http://fedora.info/download/2.0/userdocs/distribution/migration.html">migrate 
	to version 2.0</a>, then follow the appropriate upgrade steps above.</p>
	
</div>

<div id="footer">
    <div id="copyright">Copyright &copy; 2007 Fedora Project</div>

    <div id="lastModified">
      Last Modified <script type="text/javascript">
      //<![CDATA[
            var cvsDate = "$Date$";
            var parts = cvsDate.split(" ");
            var modifiedDate = parts[1];
            document.write(modifiedDate);
      //]]>
      </script>
    </div>
</div>

<!-- 
Database changes
2.2
- remove default value of "" on the following TEXT columns: dsLocation, 
operationLocation, permutation (1.56)

- ALTER TABLE ... do to dobj (1.55)

2.1
- change dsBind.dsCurrentVersionID from varchar(64) to varchar(69) (1.52)

- change datastreamPaths.token from varchar(103) to varchar(199) (1.51)

- DROP TABLE tempPaths (1.51)

- add index to dcDates.pid (1.50)

- remove duplicate indexes (1.49)

2.1b
- CREATE TABLE riMethodImplBinding

- add index doRegistry.doPID


 -->
</body>
</html>
