<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Fedora 2.1 API-M Performance</title>
    <meta name="robots" content="all"/>
    <link rel="stylesheet" title="Default" type="text/css" href="../style.css"/>
  </head>
  <body>

    <div id="head">
      Fedora 2.1 API-M Performance
    </div>

    <div id="content">
      
      <p>
      <div class="para">
        Key:
        <ul>
          <li> <span class="ok">GREEN</span> - No obvious problem (roundtrip &lt; 1 second)</li>
          <li> <span class="warning">YELLOW</span> - Possible problem (roundtrip &gt; 1 second)</li>
          <li> <span class="problem">RED</span> - Obvious problem</li>
        </ul>
      </div>
      </p>

      <h3>Test Results</h3>
      <div class="para">
      </div>

      <h4 class="warning">addDatastream</h4>
      <div class="para">
        Two tests were run:
        <ul>
          <li> Adding Inline XML - <b>1.366 seconds roundtrip</b> - <a href="addDatastream-inline-log.xml">view log</a>
               <br/>
                 <i>Looking at the server log, you
                 can see that 683 milliseconds of the roundtrip time was spent during
                 garbage collection and getting datastream content from
                 an external server.</i><p/>
               </li>
          <li> Adding Managed Content - <b>0.923 seconds roundtrip</b> - <a href="addDatastream-managed-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">addDisseminator</h4>
      <div class="para">
        <ul>
          <li> <b>0.774 seconds roundtrip</b> - <a href="addDisseminator-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">describeUser</h4>
      <div class="para">
        <ul>
          <li> <b>0.096 seconds roundtrip</b> - <a href="describeUser-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">export</h4>
      <div class="para">
        Two tests were run:
        <ul>
          <li> Exporting FOXML - <b>0.247 seconds roundtrip</b> - <a href="export-foxml-log.xml">view log</a></li>
          <li> Exporting METS - <b>0.320 seconds roundtrip</b> - <a href="export-mets-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">exportObject</h4>
      <div class="para">
        <ul>
          <li> <b>0.151 seconds roundtrip</b> - <a href="exportObject-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">getDatastream</h4>
      <div class="para">
        <ul>
          <li> <b>0.658 seconds roundtrip</b> - <a href="getDatastream-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">getDatastreamHistory</h4>
      <div class="para">
        <ul>
          <li> <b>0.164 seconds roundtrip</b> - <a href="getDatastreamHistory-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">getDatastreams</h4>
      <div class="para">
        <ul>
          <li> <b>0.164 seconds roundtrip</b> - <a href="getDatastreams-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">getDisseminator</h4>
      <div class="para">
        <ul>
          <li> <b>0.094 seconds roundtrip</b> - <a href="getDisseminator-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">getDisseminatorHistory</h4>
      <div class="para">
        <ul>
          <li> <b>0.112 seconds roundtrip</b> - <a href="getDisseminatorHistory-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">getDisseminators</h4>
      <div class="para">
        <ul>
          <li> <b>0.130 seconds roundtrip</b> - <a href="getDisseminators-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">getNextPID</h4>
      <div class="para">
        <ul>
          <li> <b>0.288 seconds roundtrip</b> - <a href="getNextPID-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">getObjectXML</h4>
      <div class="para">
        <ul>
          <li> <b>0.213 seconds roundtrip</b> - <a href="getObjectXML-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="warning">ingest</h4>
      <div class="para">
        Two tests were run:
        <ul>
          <li> Ingesting FOXML - <b>12.286 seconds roundtrip</b> - <a href="ingest-foxml-log.xml">view log</a>
               <br/>
                 <i>Looking at the server log, you
                 can see that 10.565 seconds of the roundtrip time was spent during
                 garbage collection.</i><p/>
               </li>
          <li> Ingesting METS - <b>0.491 seconds roundtrip</b> - <a href="ingest-mets-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">ingestObject</h4>
      <div class="para">
        <ul>
          <li> <b>0.452 seconds roundtrip</b> - <a href="ingestObject-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">modifyDatastreamByReference</h4>
      <div class="para">
        <ul>
          <li> <b>0.735 seconds roundtrip</b> - <a href="modifyDatastreamByReference-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">modifyDatastreamByValue</h4>
      <div class="para">
        <ul>
          <li> <b>0.729 seconds roundtrip</b> - <a href="modifyDatastreamByValue-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">modifyDisseminator</h4>
      <div class="para">
        <ul>
          <li> <b>0.880 seconds roundtrip</b> - <a href="modifyDisseminator-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="problem">modifyObject</h4>
      <div class="para">
        Two tests were run:
        <ul>
          <li> Single modifyObject Call - <b>1.119 seconds roundtrip</b> - <a href="modifyObject-once-log.xml">view log</a></li>
          <li> Three modifyObject Calls - <b>0.714, 6.390, then 6.362 seconds roundtrip</b> - <a href="modifyObject-thrice-log.xml">view log</a>
               <br/>
                 <i>For this test, you can see by the log that adding to the
                 resource index took 0.206, 5.771, then 5.853 seconds to complete.</i><p/>
               </li>
        </ul>
      </div>

      <h4 class="ok">purgeDatastream</h4>
      <div class="para">
        Two tests were run:
        <ul>
          <li> Purging Inline XML Datastream - <b>0.817 seconds roundtrip</b> - <a href="purgeDatastream-inline-log.xml">view log</a></li>
          <li> Purging Managed Datastream - <b>0.738 seconds roundtrip</b> - <a href="purgeDatastream-managed-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="problem">purgeDisseminator</h4>
      <div class="para">
        Two tests were run:
        <ul>
          <li> Purging Disseminator 'ListRecordAPI' - <b>5.756 seconds roundtrip</b> - <a href="purgeDisseminator-short-log.xml">view log</a>
          </li>
          <li> Purging Disseminator 'GetMetadataFormatAPI' - <b>2 minutes, 18.606 seconds roundtrip</b> - <a href="purgeDisseminator-long-log.xml">view log</a></li>
        </ul>
        <p>
          <i>These calls were almost identical, but purging the GetMetadataFormatAPI 
             disseminator was more expensive because many more objects "shared"
             that disseminator in the database.</i>
        </p>
      </div>

      <h4 class="problem">purgeObject</h4>
      <div class="para">
        Two tests were run:
        <ul>
          <li> Purging an Object Without Disseminators - <b>17.469 seconds roundtrip</b> - <a href="purgeObject-nodissems-log.xml">view log</a></li>
          <li> Purging an Object With Four Disseminators - <b>4 minutes, 58.376 seconds roundtrip</b> - <a href="purgeObject-fourdissems-log.xml">view log</a></li>
        </ul>
        <p>
          <i>For each call, a lot of time was spent in the FieldSearch module,
             querying the doFields table to find out whether the object being purged is
             a bDef or bMech for other objects.</i>
        </p>
        <p>
          <i>The log for the second call makes it clear that a huge amount of time is
             spent querying the database to handle an apparent corner case.
             This may be vastly improved by changing how/when the "definitional"
             table is populated, thus making deletes simpler.</i>
        </p>
      </div>

      <h4 class="warning">setDatastreamState</h4>
      <div class="para">
        <ul>
          <li> <b>1.143 seconds roundtrip</b> - <a href="setDatastreamState-log.xml">view log</a>
            <br/>
              <i>
                Garbage collection took .208 seconds and updating the dsBind
                table took .410 seconds.
              </i>
              <p/>
          </li>
        </ul>
      </div>

      <h4 class="ok">setDisseminatorState</h4>
      <div class="para">
        <ul>
          <li> <b>0.711 seconds roundtrip</b> - <a href="setDisseminatorState-log.xml">view log</a></li>
        </ul>
      </div>

      <h4 class="ok">upload</h4>
      <div class="para">
        <ul>
          <li> <b>0.198 seconds roundtrip</b> - <a href="upload-log.xml">view log</a></li>
        </ul>
      </div>


    </div>

  </body>
</html>

