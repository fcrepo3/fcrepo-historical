<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
                      
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
  <head>
    <title>API-M Performance Report</title>
    <link rel="stylesheet" type="text/css" href="../../docstyle.css" />
  </head>

  <body>

    <div id="header">
      <a href="../../../index.html">
      </a>
      <h1>API-M Performance Report</h1>
      <h2>Fedora Release 3.0 Beta 2</h2>
    </div>

    <div id="toc">
      <h2>Table of Contents</h2>
      <ol>
        <li><a href="#intro">Introduction</a></li>
        <li><a href="#environ">Test Environment</a></li>
        <li><a href="#results">Test Results</a></li>
      </ol>
    </div>
    
    <ol id="content">
    
      <li>
        <h2 id="intro">Introduction</h2>
        <span class="plaintext">
          Following the release of Fedora 2.1, we received several reports of poor API-M performance, especially when modifying and removing existing Fedora objects.
          <br />
          <br />
          To fully understand the problem, we enabled detailed server logging and executed a series of tests against all API-M methods.  After making several improvements to the Fedora server code we re-ran the original tests.
          <br />
          <br />
          The results included in this report illustrate the significant performance boost we experienced after making these changes.
        </span>
      </li>
      
      <li>
        <h2 id="environ">Test Environment</h2>
        <span class="plaintext">
          Hardware:
        </span>
          <ul>
            <li>CPUs: (4) Intel Xeon 3.60GHz (2MB cache)</li>
            <li>Physical Memory: 6GB</li>
          </ul>
        <span class="plaintext">
          Software:
        </span>
          <ul>
            <li>OS: Linux 2.6.9-11 (64-bit)</li>
            <li>Database: MySQL v4.1.10a (local instance)</li>
            <li>Java: 1.5.0_05-b05 (64-bit)</li>
          </ul>
        <span class="plaintext">
          All tests were performed on a single Fedora server with:
        </span>
          <ul>
            <li>2.1 million digital objects, each with:
              <ul>
                <li>3-5 "X" (inline XML) datastreams</li>
                <li>0-1 "R" (redirect) datastream</li>
                <li>2-4 disseminators</li>
                <li>An average FOXML size of 10kb</li>
              </ul>
            </li>
            <li>160 million triples in the Resource Index (indexing at level 2)</li>
            <li>512MB maximum Java heap size for Tomcat (this is 2x the default)</li>
            <li>Disabled policy enforcement (this is enabled by default in fedora.fcfg)</li>
            <li>Disabled JAASLoginModule for authentication (using MemoryRealm instead)</li>
          </ul>
      </li>
      
      <li>
        <h2 id="results">Test Results</h2>
        <span class="plaintext">
          Each API-M method was tested and individual logs were saved for each test. The following object was used in all tests:
        </span>
          <ul>
            <li><a href="test_PurgeMe.xml">test:PurgeMe</a></li>
          </ul>
        <span class="plaintext">
          Below are the &quot;before&quot; and &quot;after&quot; test results for API-M performance.  In the &quot;before&quot; report, take particular notice of the API-M operations highlighted in red. These operations were of most concern in terms of response time. The &quot;after&quot; report shows that these operations have been tuned and now complete within milliseconds, as do all other API-M operations.
        </span>
          <ul>
            <li><strong>BEFORE:</strong> <a href="2.1/index.html">Fedora 2.1 API-M Test Results</a></li>
            <li><strong>AFTER:</strong> <a href="2.1.1/index.html">Fedora 2.1.1 API-M Test Results</a></li>
          </ul>
        <span class="plaintext">
          Note: The following changes were made before the second test:
        </span>
          <ul>
            <li><a href="http://www.fedora.info/bugzilla/show_bug.cgi?id=152">Bug #152, "modifyDatastreamByValue delay when resourceIndex on"</a> was fixed</li>
            <li><a href="http://www.fedora.info/bugzilla/show_bug.cgi?id=156">Bug #156, "Modifying a disseminator's bmech breaks disseminations for other objects"</a> was fixed</li>
            <li><a href="http://www.fedora.info/bugzilla/show_bug.cgi?id=158">Bug #158, "purgeObject and purgeDisseminator take unreasonably long in large repositories"</a> was fixed</li>
            <li>Fedora was started with GCOnCommit = false (this is now the default bahavior for Fedora 2.1.1)</li>
          </ul>
      </li>
      
    </ol>
    
    <div id="footer">
      <p id="copyright">
        Copyright &copy; 2002-2007 Fedora Project
      </p>
      <script type="text/javascript">
        var cvsDate = "$Date: 2007-08-01 15:42:14 -0400 (Wed, 01 Aug 2007) $";
        var parts = cvsDate.split(" ");
        var modifiedDate = parts[1];
        var p = document.createElement("p");
        p.setAttribute("id", "lastModified");
        var footer = document.getElementById("footer");
        footer.appendChild(p);
        p.innerHTML = "Last Modified "+modifiedDate;
      </script>
    </div>
    
  </body>
</html>