<?xml version="1.0"?>

<!--
  $Id$
  
  TODO: Add optimized targets (separate output area)
        Add doc targets
        Add server targets, similar to client, pulling off common classes
-->

<project name="Fedora" default="all" basedir=".">

  <property name="javaClassDebug" value="on"/>
  <property name="javaClassOptimize" value="off"/>

  <property name="javaSourceDir" value="src/java"/>
  <property name="docDir" value="apidoc"/>
    
  <target name="all"
          depends="client"
          description="Build all distributions">
  </target>
  
  <target name="client" 
          depends="clientclasses,clienthelp,clientimages,clientjarincludes"
          description="Client distribution">
    <mkdir dir="dist"/>
    <mkdir dir="dist/client"/>
    <jar jarfile="dist/client/client.jar"
         basedir="temp/client"
         manifest="src/mfs/client.mfs"/>
    <mkdir dir="dist/client/lib"/>
    <copy file="lib/client/jhbasic.jar" todir="dist/client/lib"/>
    <copy file="lib/client/rms.jar" todir="dist/client/lib"/>
    <!--<copy todir="temp/client">
      <fileset dir="inc/client/dist"/>
    </copy>-->
    <echo message="Finished building client distribution in dist/client"/>
  </target>

  <target name="runclient"
          depends="client"
          description="run the client">
    <exec dir="dist/client" executable="java">
      <arg line="-jar client.jar"/>
    </exec>
  </target>
    
  <target name="prep"
          description="Prepare a temporary build area for targets">
    <mkdir dir="temp"/>
  </target>
    
  <target name="clientprep"
          depends="prep"
          description="Prepare a temporary build area for client-related targets">
    <mkdir dir="temp/client"/>
  </target>

  <target name="clientclasses"
          depends="clientprep"
          description="Compile client java code into temp/client">
    <javac srcdir="${javaSourceDir}"
           destdir="temp/client"
           classpath="lib/client/jhbasic.jar;lib/client/rms.jar"
           includes="edu/cornell/dlrg/swing/mdi/**,edu/cornell/dlrg/swing/jhelp/**,fedora/client/**"
           optimize="${javaClassOptimize}"
           debug="${javaClassDebug}"/>
  </target>
    
  <target name="clienthelp"
          depends="clientprep"
          description="Assemble JavaHelp for client into temp/client/help">
    <mkdir dir="temp/client/help"/>
    <copy todir="temp/client/help">
      <fileset dir="src/gif/client/help"/>
      <fileset dir="src/jpg/client/help"/>
      <fileset dir="src/html/client/help"/>
      <fileset dir="src/jhelpset/client/help"/>
      <fileset dir="src/jhelptoc/client/help"/>
      <fileset dir="src/jhelpindex/client/help"/>
      <fileset dir="src/jhelpmap/client/help"/>
    </copy>
  </target>
  
  <target name="clientimages"
          depends="clientprep"
          description="Assemble client images dir sources into temp/client/images">
    <mkdir dir="temp/client/images"/>
    <copy todir="temp/client/images">
      <fileset dir="src/gif/client/images"/>
    </copy>
  </target>
  
  <target name="clientjarincludes"
          depends="clientprep"
          description="Assemble client includes temp/client">
    <copy todir="temp/client">
      <fileset dir="inc/client/jar"/>
    </copy>
  </target>


<!--
  <target name="docs"
          description="Build dev docs and user docs">
  </target>    
    
  <target name="apidoc"
          description="Build the javadocs">
    <mkdir dir="apidoc"/>
    <javadoc packagenames="edu.cornell.dlrg.swing.mdi.*,edu.cornell.dlrg.swing.jhelp.*,fedora.client.*,fedora.common.*"
             sourcepath="${javaSourceDir}"
             destdir="apidoc"
             author="true"
             version="true"
             use="true"/>
  </target>
-->
    
  <target name="clean"
          description="Clean up all targets and temp files">
    <delete dir="temp"/>
    <delete dir="dist"/>
  </target>

</project>

<!--
  $Log$
  Revision 1.2  2002/05/03 16:03:32  cwilper
  Client builds now work

-->
